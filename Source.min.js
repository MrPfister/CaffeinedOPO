var pList=[];var exe=function(r){this.d=r;wO("Load the file: ["+QStr(r,0,15)+"]");if(!strcmp(QStr(r,0,15),"OPLObjectFile**")){wO("Not a valid executable");return}this.sn=CStr(r,20);wO("Source file: "+this.sn);var t=i16(r,18);wO("Offset to second header: "+t);this.t=i16(r,t+4);wO("Executable Type: "+this.t);var l=i32(r,t+8);wO("Procedure Table Offset: "+l);while(r[l]!=0||r[l+1]!=0){var f=new Object();wO("New Procedure Found: "+l);f.e=this;f.n=CStr(r,l);wO(" - Name: ["+f.n+"]");l+=r[l]+1;f.f=i32(r,l);var e=f.f;wO(" - Offset: "+f.f);l+=6;if(this.t==4383){e+=2}f.d=i16(r,e);wO(" - DSF Size: ["+f.d+"]");f.q=i16(r,e+2);wO(" - QCode Size: ["+f.q+"]");e+=6;f.ps=r[e];wO(" - Parameter Size: ["+f.ps+"]");f.p=[];for(var m=0;m<f.ps;m++){f.p.push(++e)}e++;f.gs=i16(r,e);f.gvs=[];wO(" - Global Declaration Size: ["+f.gs+"]");e+=2;if(f.gs!=0){var s=e+f.gs;do{var c=new Object();wO("New Global Declaration");c.p=this;c.n=CStr(r,e);wO(" - Global Name: ["+c.n+"]");return;e+=1+r[e];c.t=a=r[e];if(a==0){c.l=2}else{if(a==1){c.l=4}else{if(a==2){c.l=8}else{c.l=0}}}c.d=i16(r,++e);f.gvs.push(c);e+=2;if(c.l>0){DSF.reserve(c.d,c.l)}}while(e<s)}f.cps=i16(r,e);wO(" - Called Procedures: ["+f.cps+"]");e+=2;f.cp=[];var q=18+f.gs;var u=e;if(f.cps!=0){var n=e+f.cps;do{var h=new Object();wO("New Called Procedure");h.n=CStr(r,e);wO(" - Global Name: ["+h.n+"]");h.a=r[e+1+r[e]];wO(" - Arguments: "+h.a);h.o=q+e-u;wO(" - Offset: "+h.o);f.cp.push(h);e+=2+r[e]}while(e<n)}f.gr=[];var k=18+f.cps;wO("Global References");wO(" - Global Reference Offset: "+k);while(r[e]!=0){var d=new Object();wO("New Global Reference");d.n=CStr(r,e);wO(" - Name: ["+d.n+"]");d.t=r[e+1+r[e]];wO(" - Typecode: "+d.t);d.o=k;wO(" - Offset: "+d.o);f.gr.push(d);k+=2;e+=2+r[e]}e++;f.sc=[];wO("String Control section");while(r[e]!=0||r[e+1]!=0){var o=new Object();wO("New String");o.dso=i16(r,e);wO(" - Offset: "+o.dso);o.s=r[e+2];wO(" - Size: "+o.s);f.sc.push(o);e+=3}e+=2;f.ac=[];wO("Array Control section");while(r[e]!=0||r[e+1]!=0){var j=new Object();j.dso=i16(r,e);wO(" - Offset: "+j.dso);j.s=i16(r,e+2);wO(" - Size: "+j.s);f.ac.push(j);e+=4}e+=2;f.qc=r.slice(e,e+f.q);var g=18;for(var m=0;m<f.gvs.length;m++){f.gvs[m].EEi=g;g+=f.gvs[m].n.length+2}for(var m=0;m<f.cp.length;m++){f.cp[m].EEi=g;g+=f.cp[m].n.length+2}for(var m=0;m<f.p.length;m++){f.p[m].EEi=g;g+=2}for(var m=0;m<f.gr.length;m++){f.gr[m].EEi=g;g+=2}pList.push(f)}wO("Executable Loaded")};